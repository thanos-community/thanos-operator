- apiVersion: v1
  automountServiceAccountToken: true
  kind: ServiceAccount
  metadata:
    labels:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      operator.thanos.io/owner: test-owner
    name: thanos-receive-router-test-owner
    namespace: test-namespace
- apiVersion: v1
  kind: Service
  metadata:
    labels:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      app.kubernetes.io/version: v0.40.1
      operator.thanos.io/owner: test-owner
    name: thanos-receive-router-test-owner
    namespace: test-namespace
  spec:
    ports:
    - name: grpc
      port: 10901
      protocol: TCP
      targetPort: 10901
    - name: capnproto
      port: 19391
      protocol: TCP
      targetPort: 19391
    - name: http
      port: 10902
      protocol: TCP
      targetPort: 10902
    - name: remote-write
      port: 19291
      protocol: TCP
      targetPort: 19291
    selector:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      operator.thanos.io/owner: test-owner
  status:
    loadBalancer: {}
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    labels:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      app.kubernetes.io/version: v0.40.1
      operator.thanos.io/owner: test-owner
    name: thanos-receive-router-test-owner
    namespace: test-namespace
  spec:
    replicas: 0
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/component: thanos-receive-router
        app.kubernetes.io/instance: thanos-receive-router-test-owner
        app.kubernetes.io/managed-by: thanos-operator
        app.kubernetes.io/name: thanos-receive
        app.kubernetes.io/part-of: thanos
        operator.thanos.io/owner: test-owner
    strategy:
      rollingUpdate:
        maxSurge: 0
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        labels:
          app.kubernetes.io/component: thanos-receive-router
          app.kubernetes.io/instance: thanos-receive-router-test-owner
          app.kubernetes.io/managed-by: thanos-operator
          app.kubernetes.io/name: thanos-receive
          app.kubernetes.io/part-of: thanos
          app.kubernetes.io/version: v0.40.1
          operator.thanos.io/owner: test-owner
        name: thanos-receive-router-test-owner
        namespace: test-namespace
      spec:
        automountServiceAccountToken: true
        containers:
        - args:
          - receive
          - --log.level=info
          - --log.format=logfmt
          - --grpc-address=0.0.0.0:10901
          - --http-address=0.0.0.0:10902
          - --remote-write.address=0.0.0.0:19291
          - --receive.replication-factor=0
          - --receive.hashrings-file=/var/lib/thanos-receive/hashrings.json
          - "--receive.grpc-service-config={\n  \"loadBalancingPolicy\":\"round_robin\",\n
            \ \"retryPolicy\": {\n    \"maxAttempts\": 2,\n    \"initialBackoff\":
            \"0.1s\",\n    \"backoffMultiplier\": 1,\n    \"retryableStatusCodes\":
            [\n  \t  \"UNAVAILABLE\"\n    ]\n  }\n}"
          env:
          - name: POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          image: quay.io/thanos/thanos:v0.40.1:v0.39.0
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 8
            httpGet:
              path: /-/healthy
              port: 10902
            initialDelaySeconds: 5
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 1
          name: thanos-receive-router
          ports:
          - containerPort: 10901
            name: grpc
          - containerPort: 19391
            name: capnproto
          - containerPort: 10902
            name: http
          - containerPort: 19291
            name: remote-write
          readinessProbe:
            failureThreshold: 8
            httpGet:
              path: /-/ready
              port: 10902
            initialDelaySeconds: 5
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 1
          resources: {}
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            runAsNonRoot: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: FallbackToLogsOnError
          volumeMounts:
          - mountPath: /var/lib/thanos-receive
            name: hashring-config
        serviceAccountName: thanos-receive-router-test-owner
        volumes:
        - configMap:
            defaultMode: 420
            name: thanos-receive-router-test-owner
          name: hashring-config
  status: {}
- apiVersion: v1
  data:
    hashrings.json: '[{"hashring":"test","endpoints":["test:19291"]}]'
  kind: ConfigMap
  metadata:
    labels:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      app.kubernetes.io/version: v0.40.1
      operator.thanos.io/owner: test-owner
    name: thanos-receive-router-test-owner
    namespace: test-namespace
- apiVersion: policy/v1
  kind: PodDisruptionBudget
  metadata:
    labels:
      app.kubernetes.io/component: thanos-receive-router
      app.kubernetes.io/instance: thanos-receive-router-test-owner
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-receive
      app.kubernetes.io/part-of: thanos
      app.kubernetes.io/version: v0.40.1
      operator.thanos.io/owner: test-owner
    name: thanos-receive-router-test-owner
    namespace: test-namespace
  spec:
    maxUnavailable: 1
    selector:
      matchLabels:
        app.kubernetes.io/component: thanos-receive-router
        app.kubernetes.io/instance: thanos-receive-router-test-owner
        app.kubernetes.io/managed-by: thanos-operator
        app.kubernetes.io/name: thanos-receive
        app.kubernetes.io/part-of: thanos
        operator.thanos.io/owner: test-owner
  status:
    currentHealthy: 0
    desiredHealthy: 0
    disruptionsAllowed: 0
    expectedPods: 0
