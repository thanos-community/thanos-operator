apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    test: annotation
  labels:
    app.kubernetes.io/component: query-frontend
    app.kubernetes.io/instance: thanos-query-frontend-test-qf
    app.kubernetes.io/managed-by: thanos-operator
    app.kubernetes.io/name: thanos-query-frontend
    app.kubernetes.io/part-of: thanos
    operator.thanos.io/owner: test-qf
    some-custom-label: xyz
    some-other-label: abc
  name: thanos-query-frontend-test-qf
  namespace: ns
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/component: query-frontend
      app.kubernetes.io/instance: thanos-query-frontend-test-qf
      app.kubernetes.io/managed-by: thanos-operator
      app.kubernetes.io/name: thanos-query-frontend
      app.kubernetes.io/part-of: thanos
      operator.thanos.io/owner: test-qf
  strategy: {}
  template:
    metadata:
      labels:
        app.kubernetes.io/component: query-frontend
        app.kubernetes.io/instance: thanos-query-frontend-test-qf
        app.kubernetes.io/managed-by: thanos-operator
        app.kubernetes.io/name: thanos-query-frontend
        app.kubernetes.io/part-of: thanos
        operator.thanos.io/owner: test-qf
        some-custom-label: xyz
        some-other-label: abc
    spec:
      containers:
      - args:
        - query-frontend
        - --http-address=0.0.0.0:9090
        - --query-frontend.downstream-url=http://thanos-query.ns.svc:0
        - --query-frontend.log-queries-longer-than=5s
        - --query-range.split-interval=1h
        - --labels.split-interval=30m
        - --query-range.max-retries-per-request=5
        - --labels.max-retries-per-request=3
        - --cache-compression-type=snappy
        - --query-frontend.compress-responses
        image: some-custom-image:v0.39.0
        livenessProbe:
          httpGet:
            path: /-/healthy
            port: 9090
        name: thanos-query-frontend
        ports:
        - containerPort: 9090
          name: http
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /-/ready
            port: 9090
        resources: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          runAsNonRoot: true
      - args:
        - --test-arg
        env:
        - name: TEST_ENV
          value: test
        image: test-image:latest
        name: test-container
        resources: {}
      serviceAccountName: thanos-query-frontend-test-qf
status: {}
